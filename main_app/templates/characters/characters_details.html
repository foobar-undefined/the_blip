{% extends 'base.html' %}
{% block content %}
  <div class="row">
    <div class="col s12 m7">
      <div class="card">
        <div class="card-image">
          <span class="card-title">{{ char.name }}</span>
          <img src= '{{ char.thumbnail}}'  width="250" height="250">
          {% if not is_in_team %}
            <!-- Add to Team Form -->
            <form method="post" action="">
              {% csrf_token %}
              <button type="submit" class="btn btn-primary">Add to Roster</button>
            </form>
          {% else %}
              <p>This character is already in your team.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  <!-- {% if not is_in_team %}
    <form method="post" action="">
      {% csrf_token %}
      <button type="submit" class="btn btn-primary">Add to Roster</button>
    </form>
  {% else %}
    <p>This character is already in your team.</p>
  {% endif %} -->
<div class="row">
  <div class="col s6">
    <div class="carousel" style="width:100%" id="comic-carousel">
      {% for comic in comics %}
            <div class="carousel-item">
              <div class="comic-card">
                  <img class ='comic-image' src= '{{comic.thumbnail.path}}.{{ comic.thumbnail.extension}}' data-comic-id="{{comic.id}}">
              </div>
            </div>
      {% endfor %}
    </div>
  </div>
  <div class="col s6">
    <div class="comic-description">
      {% for comic in comics %}
        {% if comic.thumbnail.path %}
          <div class="comic-description-item" data-comic-id="{{comic.id}}">
            <p class="comic-title">{{comic.title}}</p>
            <p class="comic-description-text">{{ comic.description }}</p>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        let elems = document.querySelectorAll('.carousel');
        let instances = M.Carousel.init(elems);

        let comicDescriptions = document.querySelectorAll('.comic-description-item');
        comicDescriptions.forEach(function(comic){
          comic.style.display = 'none';
        });

        let carousel = document.getElementById('comic-carousel');
        carousel.addEventListener('click', function(event){
          let target = event.target;
          let comicId = target.getAttribute('data-comic-id');
          let singleDescription = document.querySelector(`.comic-description-item[data-comic-id="${comicId}"]`);

          comicDescriptions.forEach(function(comic){
            comic.style.display = 'none';
          });
          singleDescription.style.display= "block";
        });
    });
  </script>
{% endblock %}